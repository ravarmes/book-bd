<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="940" height="420" viewBox="0 0 940 420" role="img" aria-labelledby="title desc">
  <title id="title">Figura 7.3 — Fluxo DBaaS com Supabase para a Biblioteca</title>
  <desc id="desc">Arquitetura: Cliente (Power BI/Navegador) → (1) HTTP/REST → Supabase (API/DCL) → (2) SQL → PostgreSQL da Biblioteca. Setas numeradas e legenda inferior.</desc>
  <defs>
    <style><![CDATA[
      .box { fill:#f8fbff; stroke:#2a6ebb; stroke-width:2; rx:12; }
      .box-green { fill:#f3fff7; stroke:#3a9d5a; stroke-width:2; rx:12; }
      .box-yellow { fill:#fff9e6; stroke:#caa032; stroke-width:2; rx:12; }
      .title { font-family: Arial, Helvetica, sans-serif; font-size:20px; font-weight:bold; fill:#1f3b5b; }
      .label { font-family: Arial, Helvetica, sans-serif; font-size:16px; fill:#1f3b5b; }
      .small { font-family: Arial, Helvetica, sans-serif; font-size:15px; fill:#445a7a; }
      .arrow { stroke:#577ea6; stroke-width:2; marker-end:url(#arrowhead); }
      .legend { font-family: Arial, Helvetica, sans-serif; font-size:15px; fill:#3d3d3d; }
      .tag { font-family: Arial, Helvetica, sans-serif; font-size:16px; font-weight:bold; fill:#ffffff; }
    ]]></style>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#577ea6" />
    </marker>
    <linearGradient id="grad" x1="0" y1="0" x2="1" y2="1">
      <stop offset="0%" stop-color="#e8f0ff"/>
      <stop offset="100%" stop-color="#ffffff"/>
    </linearGradient>
  </defs>

  <!-- Header -->
  <rect x="20" y="20" width="900" height="60" fill="url(#grad)" stroke="#d0d8e8" rx="8" />
  <text x="40" y="58" class="title">Arquitetura DBaaS (Supabase)</text>
  <text x="600" y="58" class="small">Cliente → API REST + DCL → PostgreSQL</text>

  <!-- Client Box -->
  <rect x="60" y="130" width="240" height="190" class="box" />
  <text x="80" y="160" class="title">Cliente</text>
  <text x="80" y="190" class="label">Power BI Desktop</text>
  <text x="80" y="216" class="label">Navegador (Frontend)</text>
  <text x="80" y="242" class="small">Consulta / Visualização</text>

  <!-- API Box -->
  <rect x="350" y="110" width="260" height="220" class="box-yellow" />
  <text x="370" y="140" class="title">Supabase</text>
  <text x="370" y="168" class="label">API REST (PostgREST)</text>
  <text x="370" y="196" class="label">Autenticação (JWT)</text>
  <text x="370" y="224" class="label">Regras de Acesso (DCL)</text>
  <text x="370" y="250" class="small">Filtros, Ordenação, Paginação</text>

  <!-- DB Box -->
  <rect x="660" y="130" width="240" height="190" class="box-green" />
  <text x="680" y="160" class="title">PostgreSQL</text>
  <text x="680" y="190" class="label">Banco da Biblioteca</text>
  <text x="680" y="216" class="small">Tabelas: aluno, livro, exemplar,</text>
  <text x="680" y="236" class="small">emprestimo, reserva, avaliacao</text>

  <!-- Arrows with numeric tags -->
  <line x1="300" y1="205" x2="350" y2="205" class="arrow" />
  <circle cx="321" cy="230" r="12" fill="#577ea6" />
  <text x="317" y="235" class="tag">1</text>

  <line x1="610" y1="205" x2="660" y2="205" class="arrow" />
  <circle cx="634" cy="230" r="12" fill="#577ea6" />
  <text x="630" y="235" class="tag">2</text>

  <!-- Legend -->
  <rect x="20" y="330" width="900" height="60" fill="#f7f9fc" stroke="#d0d8e8" rx="8" />
  <text x="40" y="360" class="legend">1: HTTP/REST — Cliente → API do Supabase</text>
  <text x="40" y="384" class="legend">2: SQL — Supabase → Banco PostgreSQL</text>
</svg>
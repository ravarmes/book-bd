## üß≠ **Prompt para o agente gerar o Cap√≠tulo 7 ‚Äì Integra√ß√£o Web e BI**

> Voc√™ √© um autor t√©cnico escrevendo um livro pr√°tico sobre **Banco de Dados**, voltado para iniciantes e estudantes de cursos t√©cnicos e de gradua√ß√£o.
> O cap√≠tulo a ser escrito √© o **Cap√≠tulo 7 ‚Äì Integra√ß√£o Web e Business Intelligence (BI)**.
> O texto deve ser **did√°tico, progressivo e orientado √† pr√°tica**, com exemplos e trechos de c√≥digo, usando o **estudo de caso da Biblioteca Escolar** desenvolvido ao longo do livro.
>
> Use uma linguagem acess√≠vel e instrutiva, como em uma aula pr√°tica.
> Evite teorias longas ‚Äî priorize a experimenta√ß√£o e a visualiza√ß√£o de resultados.
>
> O banco de dados da biblioteca (j√° criado localmente pelos alunos) cont√©m as tabelas:
> `aluno`, `livro`, `exemplar`, `emprestimo`, `reserva`, `autor`, `livro_autor`, `telefone_aluno` e `avaliacao`.

---

## üìò **CAP√çTULO 7 ‚Äì Integra√ß√£o Web e *Business Intelligence* (BI)**

üåê **Ferramentas:** Supabase (DBaaS PostgreSQL) e Power BI

---

### üéØ **Objetivo Geral**

Mostrar como **publicar o banco da biblioteca na web** (via **Supabase**) e **analisar seus dados visualmente** (via **Power BI**), aplicando os conceitos de *Business Intelligence* com um enfoque totalmente pr√°tico.

---

## üß© **Estrutura e Diretrizes**

### **7.1 Introdu√ß√£o ao Business Intelligence (BI): A An√°lise Visual de Dados**

**Conceito e motiva√ß√£o:**

* Explicar que *Business Intelligence* (BI) √© o processo de transformar dados em informa√ß√µes estrat√©gicas.
* Aplicar o conceito ao contexto da biblioteca:

  * Quais s√£o os livros mais emprestados?
  * Quais autores t√™m mais t√≠tulos em circula√ß√£o?
  * Qual o n√∫mero m√©dio de reservas por aluno?
  * Qual √© a nota m√©dia das avalia√ß√µes dos empr√©stimos?

**Pr√°tica introdut√≥ria:**

> Criar um pequeno conjunto de dados fict√≠cio da tabela `emprestimo` e gerar um gr√°fico no Power BI mostrando a **quantidade de empr√©stimos por aluno**.
> Mostrar como essa simples visualiza√ß√£o j√° ajuda a perceber padr√µes de uso da biblioteca.

**Breve teoria:**

* Diferenciar consultas operacionais (ex: SQL) e an√°lises anal√≠ticas (BI).
* Apresentar os quatro tipos de an√°lise:
  **Descritiva** (o que aconteceu), **Diagn√≥stica** (por que aconteceu), **Preditiva** (o que pode acontecer), e **Prescritiva** (como agir).

---

### **7.2 Conex√£o com Power BI e An√°lise Descritiva de Dados**

**Objetivo:**
Conectar o Power BI ao banco local da biblioteca e explorar visualmente as tabelas.

**Passos pr√°ticos:**

1. Abrir o Power BI Desktop.
2. Ir em **‚ÄúObter Dados ‚Üí PostgreSQL Database‚Äù**.
3. Inserir os dados de conex√£o do banco local.
4. Selecionar as tabelas `aluno`, `livro`, `emprestimo` e `reserva`.

**Limpeza e transforma√ß√£o (Power Query):**

* Renomear colunas.
* Criar colunas calculadas (ex: dura√ß√£o de empr√©stimo).
* Filtrar empr√©stimos ativos.

**Pr√°tica:**

> Criar tr√™s gr√°ficos:
>
> * üìä Empr√©stimos por livro.
> * üìà Empr√©stimos por m√™s.
> * üìö Reservas por status (ativa, conclu√≠da, cancelada).

**Mini-insight:**
Com esses gr√°ficos, o aluno j√° visualiza **quais livros t√™m alta demanda** e **quais reservas s√£o mais recorrentes**.

---

### **7.3 Criando Dashboards e Relat√≥rios Visuais**

**Conceito:**

* Explicar o que √© um **dashboard**: painel interativo que consolida v√°rias vis√µes de um mesmo conjunto de dados.
* Refor√ßar a import√¢ncia de **indicadores-chave (KPIs)** no contexto da biblioteca, como:

  * Total de empr√©stimos.
  * Livros mais emprestados.
  * Alunos mais ativos.
  * M√©dia de avalia√ß√µes.

**Pr√°tica completa:**

> Criar um dashboard no Power BI com:
>
> * Gr√°fico de barras: *Top 5 livros mais emprestados*.
> * Gr√°fico de linha: *Empr√©stimos por m√™s*.
> * Cart√£o: *Total de reservas ativas*.
> * Filtro interativo: *Filtrar por aluno*.

**Mini-desafio:**

> Adicione um gr√°fico com a *nota m√©dia de avalia√ß√£o por livro* (usando a tabela `avaliacao`).

---

### **7.4 Publicando o Banco no Supabase (DBaaS)**

**Introdu√ß√£o:**

* Explicar o conceito de **Database as a Service (DBaaS)**.
* Mostrar o Supabase como uma solu√ß√£o gratuita, segura e baseada em PostgreSQL.

**Passos pr√°ticos:**

1. Acesse [https://supabase.com](https://supabase.com).
2. Crie uma conta e um novo projeto.
3. Copie as credenciais de acesso ao banco (host, port, user, password, database).
4. No painel SQL do Supabase, cole e execute o **script do banco da biblioteca**.
5. Confirme se as tabelas foram criadas.

**Pr√°tica:**

> Execute no Supabase o seguinte SQL para listar os livros mais emprestados:
>
> ```sql
> SELECT l.titulo, COUNT(e.id_emprestimo) AS total_emprestimos
> FROM emprestimo e
> JOIN exemplar ex ON e.cod_exemplar = ex.cod_exemplar
> JOIN livro l ON ex.isbn = l.isbn
> GROUP BY l.titulo
> ORDER BY total_emprestimos DESC;
> ```

**Resultado esperado:**
Banco da biblioteca publicado e consult√°vel via web.

---

### **7.5 API REST do Supabase: Acesso ao Banco via Web**

**Objetivo:**
Mostrar que o Supabase cria automaticamente uma **API RESTful** que permite acessar os dados da biblioteca via navegador ou requisi√ß√µes HTTP.

**Exemplo pr√°tico:**

* Acessar o *API Playground* no painel do Supabase.
* Fazer uma requisi√ß√£o REST:

  ```
  GET https://<projeto>.supabase.co/rest/v1/livro?select=titulo,isbn
  ```
* Retorno em JSON:

  ```json
  [
    {"titulo": "Dom Casmurro", "isbn": 1234},
    {"titulo": "O Corti√ßo", "isbn": 2345}
  ]
  ```

**Pr√°tica:**

> Fazer uma requisi√ß√£o para listar os exemplares dispon√≠veis:
>
> ```
> GET https://<projeto>.supabase.co/rest/v1/exemplar?status=eq.dispon√≠vel
> ```

**Integra√ß√£o com Power BI:**

* Mostrar como conectar o Power BI diretamente ao Supabase:

  * via **PostgreSQL connection string**, ou
  * via **API REST (conector Web)**.
* Explicar que isso permite atualizar os relat√≥rios automaticamente a partir do banco na nuvem.

**üìÇ Observa√ß√£o adicional (exporta√ß√£o CSV):**

> O Power BI permite exportar relat√≥rios ou tabelas em formato CSV.
> Esses arquivos podem ser reimportados no Supabase (painel SQL ‚Üí ‚ÄúImport Data‚Äù) para an√°lise ou backup.

---

### **7.6 Criando um Frontend Web com a API do Supabase**

**Objetivo:**
Construir uma p√°gina simples em HTML e JavaScript que consome a API REST do Supabase para exibir dados da biblioteca.

**Demonstra√ß√£o pr√°tica:**

> Exemplo 1 ‚Äì Listagem de Alunos:

```html
<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Alunos da Biblioteca</title>
</head>
<body>
  <h2>Lista de Alunos</h2>
  <table border="1" id="tabelaAlunos">
    <tr><th>Matr√≠cula</th><th>Nome</th></tr>
  </table>

  <script>
    async function carregarAlunos() {
      const url = "https://<projeto>.supabase.co/rest/v1/aluno?select=matricula,nome";
      const res = await fetch(url, {
        headers: { apikey: "<chave-anon-p√∫blica>" }
      });
      const alunos = await res.json();
      const tabela = document.getElementById("tabelaAlunos");
      alunos.forEach(a => {
        tabela.innerHTML += `<tr><td>${a.matricula}</td><td>${a.nome}</td></tr>`;
      });
    }
    carregarAlunos();
  </script>
</body>
</html>
```

> Exemplo 2 ‚Äì Listagem de Empr√©stimos (com JOIN simplificado):

```html
<h2>Empr√©stimos</h2>
<table border="1" id="tabelaEmprestimos">
  <tr><th>ID</th><th>Aluno</th><th>Livro</th><th>Data</th></tr>
</table>

<script>
async function carregarEmprestimos() {
  const url = "https://<projeto>.supabase.co/rest/v1/emprestimo?select=id_emprestimo,data_emprestimo,aluno(matricula,nome),exemplar(livro(titulo))";
  const res = await fetch(url, { headers: { apikey: "<chave-anon-p√∫blica>" } });
  const emprestimos = await res.json();
  const tabela = document.getElementById("tabelaEmprestimos");
  emprestimos.forEach(e => {
    tabela.innerHTML += `<tr><td>${e.id_emprestimo}</td><td>${e.aluno.nome}</td><td>${e.exemplar.livro.titulo}</td><td>${e.data_emprestimo}</td></tr>`;
  });
}
carregarEmprestimos();
</script>
```

**Conclus√£o da se√ß√£o:**

* O aluno agora v√™ os dados da biblioteca publicados e acess√≠veis na web.
* Essa pr√°tica demonstra o ciclo completo: **Banco ‚Üí Supabase ‚Üí API REST ‚Üí Frontend interativo**.

---

### **Encerramento do Cap√≠tulo**

**Resumo:**

* O aluno aprendeu a conectar o Power BI ao banco local e na nuvem.
* Publicou o banco no Supabase e explorou a API REST.
* Criou um pequeno frontend web para visualizar os dados.

**Desafio Final:**

> Desenvolva um painel no Power BI conectado ao Supabase mostrando:
>
> * Total de empr√©stimos por m√™s.
> * Top 5 livros mais emprestados.
> * Alunos com mais avalia√ß√µes registradas.
> * Taxa de reservas conclu√≠das.
>
> E, como complemento, personalize a p√°gina HTML para mostrar livros dispon√≠veis com bot√£o ‚ÄúReservar‚Äù.

